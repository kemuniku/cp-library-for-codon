# 強連結成分分解 (SCC)

N頂点M辺の有向グラフの強連結成分分解をO(N + M)で行います。  
**ACLのSCCとは使い方が異なるので注意してください。**  

## 使い方  

`SCCGraph(N: int) -> None`
- N頂点0辺の有向グラフを作成します。
- 制約: 0 ≤ N < $2^{30}$

`add_edge(now: int, nxt: int) -> None`
- 頂点now → 頂点nxt に向かう有向辺を追加します。

`scc(make_adjacency_list: bool = False) -> list[list[int]]`
- これまでに追加した辺数をMとして、N頂点M辺の有向グラフに対して強連結成分分解を行い、分解結果の頂点のリストをトポロジカルソート順に返します。
- **この関数を実行後、以下のインスタンス変数が登録されます。**
  - `self.n: int`    
  強連結成分分解の個数で、`len(self.groups)`と一致します。
  - `self.pos: list[int]`   
  長さNの配列で、`pos[now]`には頂点nowが属する連結成分の番号i(0 ≤ i < n)が入ります。  
  - `self.groups: list[list[int]]`   
  長さnの二次元リストで、**`scc(make_adjacency_list)`の返り値と一致します。**     
  `groups[i]`には、トポロジカルソート順がiの強連結成分に含まれる頂点のリストが入ります。
  - `self.G: list[list[int]]`  
  長さnの二次元リストで、**`scc(make_adjacency_list = True)`の時のみ追加で作成します**。  
  `G[i]`には、トポロジカルソート順がiの強連結成分から**直接**辺でつながる、異なる強連結成分j(i < j < n)のリストが入ります。  
  追加でかかる計算量: 時間・空間ともに O(N + M)
- 強連結成分分解の結果について、以下を保証します。
  - 頂点nowと頂点nxtが同一の強連結成分に属するときに限り、1本以上の有向辺を伝って**互いに**到達できる。
  - 強連結成分の番号はトポロジカルソート順である。すなわち、以下を満たす。
    - i < jのとき、強連結成分iに属する頂点から強連結成分jに属する頂点には**到達できるかもしれない**。  
    - i > jのとき、強連結成分iに属する頂点から強連結成分jに属する頂点には**絶対に到達できない**。
- 計算量: 時間・空間ともに O(N + M)





